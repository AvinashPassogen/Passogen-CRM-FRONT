<!-- Begin page -->
<div id="wrapper" class="rw">
    <div class="content-page">
        <div class="content">
            <!-- Start Content-->
            <div class="container-fluid ">
                <br>
               
                <div class="row">
                    <div class="col-12">
                        <div class="card-box exp2">
                            <h4 class="header-title">Opportunity-information</h4>

                            <div class="mb-2">
                                <div class="row">
                                    <div class="col-12 text-sm-center form-inline">
                                        <div class="form-group mr-2">
                                            <select id="demo-foo-filter-status" class="custom-select custom-select-sm">
                                                <option value="">All opportunities</option>
                                                <option value="active">opportunities</option>
                                                <option value="disabled">Recently Viewed (Pinned list)</option>
                                                <option value="suspended">Recently Viewed opportunities</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <input id="demo-foo-search" type="text" placeholder="Search"
                                                class="form-control form-control-sm" autocomplete="on">
                                        </div>


                                        <div class="col-sm-8 splitOp">
                                            <div class="text-sm-right">
                                                <div class="btn-group mb-1">
                                                    <button type="button" class="btn btn-primary back1 waves-effect waves-light ml-2" data-toggle="modal" data-target="#opportunitymodal"><i class="mdi mdi-plus-circle mr-1"></i>New</button> &nbsp;&nbsp;
                                                   
                                                    <button type="button" class="btn btn-primary back1 dropdown-toggle"
                                                        data-toggle="dropdown" aria-haspopup="true"
                                                        aria-expanded="false">
                                                        <i class="mdi mdi-view-list mdi-12px"></i><span
                                                            class="pro-user-name mr-1"><i
                                                                class="mdi mdi-chevron-down"></i></span> </button>

                                                    <ul class="dropdown-menu" *ngFor="let opp of opportunities ">
                                                        <li>
                                                            <a routerLink="/Opportunity-view" class="dropdown-item"
                                                                routerLinkActive="active">
                                                                <i class="mdi mdi-check-bold backcolor"></i>Table view</a>
                                                       </li>
                                                       <li> <a routerLink="/oppo-split/{{opp.id}}" class="dropdown-item "
                                                            routerLinkActive="active"> <i
                                                                class="mdi mdi-view-split-vertical "></i> Split view</a>
                                                            </li>
                                                            
                                                       </ul>
                                                                                                                                                    
                                                </div>
                                            </div>
                                        </div>
                                        

                                    </div>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table id="demo-foo-filtering" class="table table-bordered toggle-circle mb-0"
                                    data-page-size="10">
                                    <thead>
                                        <tr>
                                            <th data-toggle="true">Opportunity Name</th>
                                            <th data-hide="phone">Account Name</th>
                                            <th data-hide="phone">Type</th>
                                            <th data-toggle="true">Closed Date</th>
                                          
                                            <th data-hide="phone">Action</th>

                                        </tr>
                                    </thead>

                                    <tbody>
                                        <tr *ngFor="let opp of opportunities ">

                                            <td><a routerLink="/oppoStatus/{{opp.id}}" 
                                                    routerLinkActive="active">
                                                    {{opp.opportunity_name}}</a></td>
                                            <!-- <td>{{task.subject}}</td> -->
                                            <td>{{opp.account_name}}</td>
                                            <td>{{opp.type}}</td>
                                            <td>{{opp.close_date}}</td>

                                            <td>


                                                <a href="javascript:void(0);" (click)="selectPolicy(opp)"
                                                    data-toggle="modal" data-target="#modal" class="action-icon">
                                                    <i class="mdi mdi-square-edit-outline"></i></a>

                                                <a href="javascript:void(0);" (click)="deleteOpportunity(opp.id)"
                                                    class="action-icon"> <i class="mdi mdi-delete"></i></a>
                                            </td>

                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr class="active">
                                            <td colspan="10">
                                                <div class="text-right">
                                                    <ul class="pagination pagination-rounded justify-content-end 
                                                        footable-pagination m-t-10 mb-0">
                                                    </ul>
                                                </div>
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div> <!-- end .table-responsive-->
                        </div> <!-- end card-box -->
                    </div> <!-- end col -->
                </div>
                <!-- end row -->
            </div> <!-- container -->

        </div> <!-- content -->
    </div><!-- End Page content -->

</div><!-- END wrapper -->


<div class="modal fade" id="modal" *ngIf="selectedPolicy"  tabindex="-1" role="dialog" aria-hidden="true">
    <!-- <ng-template #editProfileModal let-modal> -->
    <div class="modal-dialog modal-dialog-centered modal-size">  
        <div class="modal-content">
            <div class="modal-header bg-light">
                <h4 class="modal-title" id="myCenterModalLabel">Update Opportunity</h4>
                <button type="button" class="close" (click)="resetForm();" data-dismiss="modal" aria-hidden="true">Ã—</button>
            </div>
        
            <div class="modal-body p-4">
                <form class="form-horizontal" [formGroup]="opportunityForm" class="form">
                    <div>
                        <p class="bg-light font-weight-bold label">Opportunity Information</p>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="row">
                                
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Opportunity Name</label>
                                        <input type="text" formControlName="opportunity_name" [(ngModel)] = "selectedPolicy.opportunity_name" required="true" name="opportunity_name" class="form-control input" required
                                            placeholder="Type something"/>
                                    </div>
                                    
                                </div>
                                
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Opportunity Owner</label>
                                        <input type="text" formControlName="opportunity_owner" [(ngModel)] = "selectedPolicy.opportunity_owner" required="true" name="opportunity_owner" class="form-control input" required
                                            placeholder="Type something"/>
                                    </div>
                                    
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Account Name</label>
                                        <input type="text" formControlName="account_name" [(ngModel)] = "selectedPolicy.account_name" required="true" name="account_name" class="form-control input" required
                                            placeholder="Type something"/>
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="row">
                                
                               
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Close Date</label> 
                                        <input type="date" formControlName="close_date" [(ngModel)] = "selectedPolicy.close_date" name="close_date" class="form-control input" required
                                            placeholder="Type something"/>
                                    </div>
                                    
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Type</label>
                                        <input type="text" formControlName="type" [(ngModel)] = "selectedPolicy.type" required="true" name="type" class="form-control input" required
                                            placeholder="Type something"/>
                                    </div>
                                    
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Stage</label>
                                        <select  class="form-control input" [(ngModel)] = "selectedPolicy.stage" formControlName="stage" name="stage" required="">
                                            <option value="">--None--</option>
                                                                    <option value="1">Qualification</option>
                                                                    <option value="2">Needs Analysis</option>
                                                                    <option value="3">Proposal</option>
                                                                    <option value="4">Negotiation</option>
                                                                    <option value="5">Closed Won</option>
                                                                    <option value="6">Closed Lost</option>

                                        </select>
                                    </div>
                                    
                             </div>
                            </div>
                           

                            <div class="row">
                                
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Primary Campaign Source</label>
                                        <input type="text" formControlName="primary_csource" [(ngModel)] = "selectedPolicy.primary_csource" required="true" name="primary_csource" class="form-control input" required
                                            placeholder="Type something"/>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Probability(%)</label>
                                        <input type="text" formControlName="probability" [(ngModel)] = "selectedPolicy.probability" required="true" name="probability" class="form-control input" required
                                            placeholder="Type something"/>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Amount</label>
                                        <input type="text" formControlName="amount" [(ngModel)] = "selectedPolicy.amount" required="true" name="amount" class="form-control input" required
                                            placeholder="Type something"/>
                                    </div>
                                </div>
                            </div>
                             
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <div class="mt-3" style="font-size: smaller;">
                                        
                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" [(ngModel)] = "selectedPolicy.budget_confirmed" formControlName="budget_confirmed" id="budget_confirmed">
                                                <label class="custom-control-label" for="budget_confirmed">Budget Confirmed</label>
                                            </div>
                                        </div>    
                                        </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <div class="mt-3" style="font-size: smaller;">

                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" [(ngModel)] = "selectedPolicy.discovery_completed" formControlName="discovery_completed"  id="discovery_completed">
                                                <label class="custom-control-label" for="discovery_completed">Discovery Completed</label>
                                            </div>
                                        </div> 
                                        </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">   
                                        <div class="mt-3" style="font-size: smaller;">

                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" [(ngModel)] = "selectedPolicy.roi_analysis_completed" formControlName="roi_analysis_completed" id="roi_analysis_completed">
                                                <label class="custom-control-label" for="roi_analysis_completed">ROI Analysis Completed</label>
                                            </div>
                                        </div>
                                        
                                        </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label" for="heard">Loss Reason</label>
                                        <select  class="form-control input" formControlName="loss_reason" [(ngModel)] = "selectedPolicy.loss_reason" name="loss_reason" required="">
                                            <option value="">--None--</option>
                                            <option value="Open">Lost To Competitor</option>
                                            <option value="Completed">No Budget / Lost Funding</option>
                                            <option value="Completed">No Decision / Non-Responsive</option>
                                            <option value="Completed">Price</option>
                                            <option value="Completed">Other</option>

                                        </select>
                                    </div>
                                    
                                </div>
                            </div>
                           
                            <div>
                                <p class="bg-light font-weight-bold label">Additional Information</p>
                            </div>

                            <div class="row">
                                
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Next Step</label>
                                        <input type="text" formControlName="next_step" required="true" [(ngModel)] = "selectedPolicy.next_step" name="next_step" class="form-control input" required
                                            placeholder="Type something"/>
                                    </div>
                                    
                                </div>
                                <div class="col-sm-4">
                                   
                                    <div class="form-group">
                                        <label class="label" for="heard">Lead Source</label>
                                        <select  class="form-control input" formControlName="lead_source" [(ngModel)] = "selectedPolicy.lead_source" name="lead_source" required="">
                                            <option value="">--None--</option>
                                            <option value="Web">Web</option>
                                            <option value="Phone Inquiry">Phone Inquiry</option>
                                            <option value="Partner Referral">Partner Referral</option>
                                            <option value="Purchase List">Purchase List</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Description</label>
                                        <textarea type="text" name="description" formControlName="description" [(ngModel)] = "selectedPolicy.description" class="form-control input" placeholder="Description..."></textarea>                            
                                    </div>
                                </div>
                            </div>
                            
                                                                                
                            <div class="row">
                                <div class="form-group mb-0 button">
                                    <div>
                                        <button type="submit" (click)="Update(selectedPolicy.id)" data-dismiss="modal"  class="btn btn-primary waves-effect waves-light button">
                                            Update
                                        </button>
                                        
                                        <button type="reset" class="close" data-dismiss="modal" aria-hidden="true" class="btn btn-secondary waves-effect m-l-5 button">
                                            Cancel
                                        </button>
                                    </div>
                                </div> 
                            </div>      
                        </div>
                    </div>
                </form>
            </div>
        </div>    
    <!-- </ng-template> -->
    </div>
</div>


